/*! filer 0.0.38 2014-10-17 */
!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;"undefined"!=typeof window?e=window:"undefined"!=typeof global?e=global:"undefined"!=typeof self&&(e=self),e.Filer=t()}}(function(){var t;return function e(t,n,r){function i(s,a){if(!n[s]){if(!t[s]){var u="function"==typeof require&&require;if(!a&&u)return u(s,!0);if(o)return o(s,!0);throw Error("Cannot find module '"+s+"'")}var c=n[s]={exports:{}};t[s][0].call(c.exports,function(e){var n=t[s][1][e];return i(n?n:e)},c,c.exports,e,t,n,r)}return n[s].exports}for(var o="function"==typeof require&&require,s=0;r.length>s;s++)i(r[s]);return i}({1:[function(e,n){(function(e){(function(){var r={};void 0!==e&&e.nextTick?(r.nextTick=e.nextTick,r.setImmediate="undefined"!=typeof setImmediate?function(t){setImmediate(t)}:r.nextTick):"function"==typeof setImmediate?(r.nextTick=function(t){setImmediate(t)},r.setImmediate=r.nextTick):(r.nextTick=function(t){setTimeout(t,0)},r.setImmediate=r.nextTick),r.eachSeries=function(t,e,n){if(n=n||function(){},!t.length)return n();var r=0,i=function(){e(t[r],function(e){e?(n(e),n=function(){}):(r+=1,r>=t.length?n():i())})};i()},r.forEachSeries=r.eachSeries,t!==void 0&&t.amd?t([],function(){return r}):n!==void 0&&n.exports?n.exports=r:root.async=r})()}).call(this,e("JkpR2F"))},{JkpR2F:10}],2:[function(t,e){function n(t,e){for(var n=e.length-1;n>=0;n--)e[n]===t&&e.splice(n,1);return e}var r=function(){};r.createInterface=function(t){var e={};return e.on=function(e,n){this[t]===void 0&&(this[t]={}),this[t].hasOwnProperty(e)||(this[t][e]=[]),this[t][e].push(n)},e.off=function(e,r){void 0!==this[t]&&this[t].hasOwnProperty(e)&&n(r,this[t][e])},e.trigger=function(e){if(this[t]!==void 0&&this[t].hasOwnProperty(e))for(var n=Array.prototype.slice.call(arguments,1),r=0;this[t][e].length>r;r++)this[t][e][r].apply(this[t][e][r],n)},e.removeAllListeners=function(e){if(void 0!==this[t]){var n=this;n[t][e].forEach(function(t){n.off(e,t)})}},e};var i=r.createInterface("_handlers");r.prototype._on=i.on,r.prototype._off=i.off,r.prototype._trigger=i.trigger;var o=r.createInterface("handlers");r.prototype.on=function(){o.on.apply(this,arguments),Array.prototype.unshift.call(arguments,"on"),this._trigger.apply(this,arguments)},r.prototype.off=o.off,r.prototype.trigger=o.trigger,r.prototype.removeAllListeners=o.removeAllListeners,e.exports=r},{}],3:[function(t,e){(function(n){function r(t,e){var n=0;return function(){var r=Date.now();r-n>t&&(n=r,e.apply(this,arguments))}}function i(t,e){if(void 0!==t&&t||(t={}),"object"==typeof e)for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}function o(){var t=this,e=Date.now();this.origin=a(),this.lastMessage=e,this.receivedIDs={},this.previousValues={};var r=function(){t._onStorageEvent.apply(t,arguments)};"undefined"!=typeof document&&(document.attachEvent?document.attachEvent("onstorage",r):n.addEventListener("storage",r,!1))}var s=t("./eventemitter.js"),a=t("../src/shared.js").guid,u=function(t){return t===void 0||t.localStorage===void 0?{getItem:function(){},setItem:function(){},removeItem:function(){}}:t.localStorage}(n);o.prototype._transaction=function(t){function e(){if(!s){var f=Date.now(),d=0|u.getItem(l);if(d&&r>f-d)return a||(o._on("storage",e),a=!0),c=setTimeout(e,i),void 0;s=!0,u.setItem(l,f),t(),n()}}function n(){a&&o._off("storage",e),c&&clearTimeout(c),u.removeItem(l)}var r=1e3,i=20,o=this,s=!1,a=!1,c=null;e()},o.prototype._cleanup_emit=r(100,function(){var t=this;t._transaction(function(){var t,e=Date.now(),n=e-d,r=0;try{t=JSON.parse(u.getItem(c)||"[]")}catch(i){t=[]}for(var o=t.length-1;o>=0;o--)n>t[o].timestamp&&(t.splice(o,1),r++);r>0&&u.setItem(c,JSON.stringify(t))})}),o.prototype._cleanup_once=r(100,function(){var t=this;t._transaction(function(){var e,n;Date.now();var r=0;try{n=JSON.parse(u.getItem(f)||"{}")}catch(i){n={}}for(e in n)t._once_expired(e,n)&&(delete n[e],r++);r>0&&u.setItem(f,JSON.stringify(n))})}),o.prototype._once_expired=function(t,e){if(!e)return!0;if(!e.hasOwnProperty(t))return!0;if("object"!=typeof e[t])return!0;var n=e[t].ttl||p,r=Date.now(),i=e[t].timestamp;return r-n>i},o.prototype._localStorageChanged=function(t,e){if(t&&t.key)return t.key===e;var n=u.getItem(e);return n===this.previousValues[e]?!1:(this.previousValues[e]=n,!0)},o.prototype._onStorageEvent=function(t){t=t||n.event;var e=this;this._localStorageChanged(t,c)&&this._transaction(function(){var t,n=Date.now(),r=u.getItem(c);try{t=JSON.parse(r||"[]")}catch(i){t=[]}for(var o=0;t.length>o;o++)if(t[o].origin!==e.origin&&!(t[o].timestamp<e.lastMessage)){if(t[o].id){if(e.receivedIDs.hasOwnProperty(t[o].id))continue;e.receivedIDs[t[o].id]=!0}e.trigger(t[o].name,t[o].payload)}e.lastMessage=n}),this._trigger("storage",t)},o.prototype._emit=function(t,e,n){if(n="string"==typeof n||"number"==typeof n?n+"":null,n&&n.length){if(this.receivedIDs.hasOwnProperty(n))return;this.receivedIDs[n]=!0}var r={id:n,name:t,origin:this.origin,timestamp:Date.now(),payload:e},i=this;this._transaction(function(){var n=u.getItem(c)||"[]",o="[]"===n?"":",";n=[n.substring(0,n.length-1),o,JSON.stringify(r),"]"].join(""),u.setItem(c,n),i.trigger(t,e),setTimeout(function(){i._cleanup_emit()},50)})},o.prototype.emit=function(t,e){this._emit.apply(this,arguments),this._trigger("emit",t,e)},o.prototype.once=function(t,e,n){if(o.supported){var r=this;this._transaction(function(){var i;try{i=JSON.parse(u.getItem(f)||"{}")}catch(o){i={}}r._once_expired(t,i)&&(i[t]={},i[t].timestamp=Date.now(),"number"==typeof n&&(i[t].ttl=1e3*n),u.setItem(f,JSON.stringify(i)),e(),setTimeout(function(){r._cleanup_once()},50))})}},i(o.prototype,s.prototype),o.supported=u!==void 0;var c="intercom",f="intercom_once",l="intercom_lock",d=5e4,p=36e5;o.destroy=function(){u.removeItem(l),u.removeItem(c),u.removeItem(f)},o.getInstance=function(){var t;return function(){return t||(t=new o),t}}(),e.exports=o}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../src/shared.js":27,"./eventemitter.js":2}],4:[function(t,e){function n(t,e){return g.call(t,e)}function r(t){return null==t?0:t.length===+t.length?t.length:m(t).length}function i(t){return t}function o(t,e,n){var r,i;if(null!=t)if(l&&t.forEach===l)t.forEach(e,n);else if(t.length===+t.length){for(r=0,i=t.length;i>r;r++)if(e.call(n,t[r],r,t)===v)return}else{var o=o(t);for(r=0,i=o.length;i>r;r++)if(e.call(n,t[o[r]],o[r],t)===v)return}}function s(t,e,n){e||(e=i);var r=!1;return null==t?r:p&&t.some===p?t.some(e,n):(o(t,function(t,i,o){return r||(r=e.call(n,t,i,o))?v:void 0}),!!r)}function a(t,e){return null==t?!1:d&&t.indexOf===d?-1!=t.indexOf(e):s(t,function(t){return t===e})}function u(t){this.value=t}function c(t){return t&&"object"==typeof t&&!Array.isArray(t)&&g.call(t,"__wrapped__")?t:new u(t)}var f=Array.prototype,l=f.forEach,d=f.indexOf,p=f.some,h=Object.prototype,g=h.hasOwnProperty,E=Object.keys,v={},m=E||function(t){if(t!==Object(t))throw new TypeError("Invalid object");var e=[];for(var r in t)n(t,r)&&e.push(r);return e};u.prototype.has=function(t){return n(this.value,t)},u.prototype.contains=function(t){return a(this.value,t)},u.prototype.size=function(){return r(this.value)},e.exports=c},{}],5:[function(t,e,n){(function(t){"use strict";n.encode=function(e){var n,r=new Uint8Array(e),i=r.length,o="";for(n=0;i>n;n+=3)o+=t[r[n]>>2],o+=t[(3&r[n])<<4|r[n+1]>>4],o+=t[(15&r[n+1])<<2|r[n+2]>>6],o+=t[63&r[n+2]];return 2===i%3?o=o.substring(0,o.length-1)+"=":1===i%3&&(o=o.substring(0,o.length-2)+"=="),o},n.decode=function(e){var n,r,i,o,s,a=.75*e.length,u=e.length,c=0;"="===e[e.length-1]&&(a--,"="===e[e.length-2]&&a--);var f=new ArrayBuffer(a),l=new Uint8Array(f);for(n=0;u>n;n+=4)r=t.indexOf(e[n]),i=t.indexOf(e[n+1]),o=t.indexOf(e[n+2]),s=t.indexOf(e[n+3]),l[c++]=r<<2|i>>4,l[c++]=(15&i)<<4|o>>2,l[c++]=(3&o)<<6|63&s;return f}})("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/")},{}],6:[function(t,e,n){function r(t,e,n){if(!(this instanceof r))return new r(t,e,n);var i,o=typeof t;if("number"===o)i=t>0?t>>>0:0;else if("string"===o)"base64"===e&&(t=I(t)),i=r.byteLength(t,e);else{if("object"!==o||null===t)throw new TypeError("must start with number, buffer, array or string");"Buffer"===t.type&&P(t.data)&&(t=t.data),i=+t.length>0?Math.floor(+t.length):0}if(this.length>M)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+M.toString(16)+" bytes");var s;r.TYPED_ARRAY_SUPPORT?s=r._augment(new Uint8Array(i)):(s=this,s.length=i,s._isBuffer=!0);var a;if(r.TYPED_ARRAY_SUPPORT&&"number"==typeof t.byteLength)s._set(t);else if(A(t))if(r.isBuffer(t))for(a=0;i>a;a++)s[a]=t.readUInt8(a);else for(a=0;i>a;a++)s[a]=(t[a]%256+256)%256;else if("string"===o)s.write(t,0,e);else if("number"===o&&!r.TYPED_ARRAY_SUPPORT&&!n)for(a=0;i>a;a++)s[a]=0;return s}function i(t,e,n,r){n=Number(n)||0;var i=t.length-n;r?(r=Number(r),r>i&&(r=i)):r=i;var o=e.length;if(0!==o%2)throw Error("Invalid hex string");r>o/2&&(r=o/2);for(var s=0;r>s;s++){var a=parseInt(e.substr(2*s,2),16);if(isNaN(a))throw Error("Invalid hex string");t[n+s]=a}return s}function o(t,e,n,r){var i=D(R(e),t,n,r);return i}function s(t,e,n,r){var i=D(S(e),t,n,r);return i}function a(t,e,n,r){return s(t,e,n,r)}function u(t,e,n,r){var i=D(x(e),t,n,r);return i}function c(t,e,n,r){var i=D(_(e),t,n,r);return i}function f(t,e,n){return 0===e&&n===t.length?L.fromByteArray(t):L.fromByteArray(t.slice(e,n))}function l(t,e,n){var r="",i="";n=Math.min(t.length,n);for(var o=e;n>o;o++)127>=t[o]?(r+=N(i)+String.fromCharCode(t[o]),i=""):i+="%"+t[o].toString(16);return r+N(i)}function d(t,e,n){var r="";n=Math.min(t.length,n);for(var i=e;n>i;i++)r+=String.fromCharCode(t[i]);return r}function p(t,e,n){return d(t,e,n)}function h(t,e,n){var r=t.length;(!e||0>e)&&(e=0),(!n||0>n||n>r)&&(n=r);for(var i="",o=e;n>o;o++)i+=j(t[o]);return i}function g(t,e,n){for(var r=t.slice(e,n),i="",o=0;r.length>o;o+=2)i+=String.fromCharCode(r[o]+256*r[o+1]);return i}function E(t,e,n){if(0!==t%1||0>t)throw new RangeError("offset is not uint");if(t+e>n)throw new RangeError("Trying to access beyond buffer length")}function v(t,e,n,i,o,s){if(!r.isBuffer(t))throw new TypeError("buffer must be a Buffer instance");if(e>o||s>e)throw new TypeError("value is out of bounds");if(n+i>t.length)throw new TypeError("index out of range")}function m(t,e,n,r){0>e&&(e=65535+e+1);for(var i=0,o=Math.min(t.length-n,2);o>i;i++)t[n+i]=(e&255<<8*(r?i:1-i))>>>8*(r?i:1-i)}function y(t,e,n,r){0>e&&(e=4294967295+e+1);for(var i=0,o=Math.min(t.length-n,4);o>i;i++)t[n+i]=255&e>>>8*(r?i:3-i)}function w(t,e,n,r,i,o){if(e>i||o>e)throw new TypeError("value is out of bounds");if(n+r>t.length)throw new TypeError("index out of range")}function b(t,e,n,r,i){return i||w(t,e,n,4,3.4028234663852886e38,-3.4028234663852886e38),B.write(t,e,n,r,23,4),n+4}function O(t,e,n,r,i){return i||w(t,e,n,8,1.7976931348623157e308,-1.7976931348623157e308),B.write(t,e,n,r,52,8),n+8}function I(t){for(t=T(t).replace(C,"");0!==t.length%4;)t+="=";return t}function T(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function A(t){return P(t)||r.isBuffer(t)||t&&"object"==typeof t&&"number"==typeof t.length}function j(t){return 16>t?"0"+t.toString(16):t.toString(16)}function R(t){for(var e=[],n=0;t.length>n;n++){var r=t.charCodeAt(n);if(127>=r)e.push(r);else{var i=n;r>=55296&&57343>=r&&n++;for(var o=encodeURIComponent(t.slice(i,n+1)).substr(1).split("%"),s=0;o.length>s;s++)e.push(parseInt(o[s],16))}}return e}function S(t){for(var e=[],n=0;t.length>n;n++)e.push(255&t.charCodeAt(n));return e}function _(t){for(var e,n,r,i=[],o=0;t.length>o;o++)e=t.charCodeAt(o),n=e>>8,r=e%256,i.push(r),i.push(n);return i}function x(t){return L.toByteArray(t)}function D(t,e,n,r){for(var i=0;r>i&&!(i+n>=e.length||i>=t.length);i++)e[i+n]=t[i];return i}function N(t){try{return decodeURIComponent(t)}catch(e){return String.fromCharCode(65533)}}var L=t("base64-js"),B=t("ieee754"),P=t("is-array");n.Buffer=r,n.SlowBuffer=r,n.INSPECT_MAX_BYTES=50,r.poolSize=8192;var M=1073741823;r.TYPED_ARRAY_SUPPORT=function(){try{var t=new ArrayBuffer(0),e=new Uint8Array(t);return e.foo=function(){return 42},42===e.foo()&&"function"==typeof e.subarray&&0===new Uint8Array(1).subarray(1,1).byteLength}catch(n){return!1}}(),r.isBuffer=function(t){return!(null==t||!t._isBuffer)},r.compare=function(t,e){if(!r.isBuffer(t)||!r.isBuffer(e))throw new TypeError("Arguments must be Buffers");for(var n=t.length,i=e.length,o=0,s=Math.min(n,i);s>o&&t[o]===e[o];o++);return o!==s&&(n=t[o],i=e[o]),i>n?-1:n>i?1:0},r.isEncoding=function(t){switch((t+"").toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},r.concat=function(t,e){if(!P(t))throw new TypeError("Usage: Buffer.concat(list[, length])");if(0===t.length)return new r(0);if(1===t.length)return t[0];var n;if(void 0===e)for(e=0,n=0;t.length>n;n++)e+=t[n].length;var i=new r(e),o=0;for(n=0;t.length>n;n++){var s=t[n];s.copy(i,o),o+=s.length}return i},r.byteLength=function(t,e){var n;switch(t+="",e||"utf8"){case"ascii":case"binary":case"raw":n=t.length;break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":n=2*t.length;break;case"hex":n=t.length>>>1;break;case"utf8":case"utf-8":n=R(t).length;break;case"base64":n=x(t).length;break;default:n=t.length}return n},r.prototype.length=void 0,r.prototype.parent=void 0,r.prototype.toString=function(t,e,n){var r=!1;if(e>>>=0,n=void 0===n||1/0===n?this.length:n>>>0,t||(t="utf8"),0>e&&(e=0),n>this.length&&(n=this.length),e>=n)return"";for(;;)switch(t){case"hex":return h(this,e,n);case"utf8":case"utf-8":return l(this,e,n);case"ascii":return d(this,e,n);case"binary":return p(this,e,n);case"base64":return f(this,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return g(this,e,n);default:if(r)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),r=!0}},r.prototype.equals=function(t){if(!r.isBuffer(t))throw new TypeError("Argument must be a Buffer");return 0===r.compare(this,t)},r.prototype.inspect=function(){var t="",e=n.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,e).match(/.{2}/g).join(" "),this.length>e&&(t+=" ... ")),"<Buffer "+t+">"},r.prototype.compare=function(t){if(!r.isBuffer(t))throw new TypeError("Argument must be a Buffer");return r.compare(this,t)},r.prototype.get=function(t){return console.log(".get() is deprecated. Access using array indexes instead."),this.readUInt8(t)},r.prototype.set=function(t,e){return console.log(".set() is deprecated. Access using array indexes instead."),this.writeUInt8(t,e)},r.prototype.write=function(t,e,n,r){if(isFinite(e))isFinite(n)||(r=n,n=void 0);else{var f=r;r=e,e=n,n=f}e=Number(e)||0;var l=this.length-e;n?(n=Number(n),n>l&&(n=l)):n=l,r=((r||"utf8")+"").toLowerCase();var d;switch(r){case"hex":d=i(this,t,e,n);break;case"utf8":case"utf-8":d=o(this,t,e,n);break;case"ascii":d=s(this,t,e,n);break;case"binary":d=a(this,t,e,n);break;case"base64":d=u(this,t,e,n);break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":d=c(this,t,e,n);break;default:throw new TypeError("Unknown encoding: "+r)}return d},r.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},r.prototype.slice=function(t,e){var n=this.length;if(t=~~t,e=void 0===e?n:~~e,0>t?(t+=n,0>t&&(t=0)):t>n&&(t=n),0>e?(e+=n,0>e&&(e=0)):e>n&&(e=n),t>e&&(e=t),r.TYPED_ARRAY_SUPPORT)return r._augment(this.subarray(t,e));for(var i=e-t,o=new r(i,void 0,!0),s=0;i>s;s++)o[s]=this[s+t];return o},r.prototype.readUInt8=function(t,e){return e||E(t,1,this.length),this[t]},r.prototype.readUInt16LE=function(t,e){return e||E(t,2,this.length),this[t]|this[t+1]<<8},r.prototype.readUInt16BE=function(t,e){return e||E(t,2,this.length),this[t]<<8|this[t+1]},r.prototype.readUInt32LE=function(t,e){return e||E(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},r.prototype.readUInt32BE=function(t,e){return e||E(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},r.prototype.readInt8=function(t,e){return e||E(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},r.prototype.readInt16LE=function(t,e){e||E(t,2,this.length);var n=this[t]|this[t+1]<<8;return 32768&n?4294901760|n:n},r.prototype.readInt16BE=function(t,e){e||E(t,2,this.length);var n=this[t+1]|this[t]<<8;return 32768&n?4294901760|n:n},r.prototype.readInt32LE=function(t,e){return e||E(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},r.prototype.readInt32BE=function(t,e){return e||E(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},r.prototype.readFloatLE=function(t,e){return e||E(t,4,this.length),B.read(this,t,!0,23,4)},r.prototype.readFloatBE=function(t,e){return e||E(t,4,this.length),B.read(this,t,!1,23,4)},r.prototype.readDoubleLE=function(t,e){return e||E(t,8,this.length),B.read(this,t,!0,52,8)},r.prototype.readDoubleBE=function(t,e){return e||E(t,8,this.length),B.read(this,t,!1,52,8)},r.prototype.writeUInt8=function(t,e,n){return t=+t,e>>>=0,n||v(this,t,e,1,255,0),r.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=t,e+1},r.prototype.writeUInt16LE=function(t,e,n){return t=+t,e>>>=0,n||v(this,t,e,2,65535,0),r.TYPED_ARRAY_SUPPORT?(this[e]=t,this[e+1]=t>>>8):m(this,t,e,!0),e+2},r.prototype.writeUInt16BE=function(t,e,n){return t=+t,e>>>=0,n||v(this,t,e,2,65535,0),r.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=t):m(this,t,e,!1),e+2},r.prototype.writeUInt32LE=function(t,e,n){return t=+t,e>>>=0,n||v(this,t,e,4,4294967295,0),r.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=t):y(this,t,e,!0),e+4},r.prototype.writeUInt32BE=function(t,e,n){return t=+t,e>>>=0,n||v(this,t,e,4,4294967295,0),r.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=t):y(this,t,e,!1),e+4},r.prototype.writeInt8=function(t,e,n){return t=+t,e>>>=0,n||v(this,t,e,1,127,-128),r.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),0>t&&(t=255+t+1),this[e]=t,e+1},r.prototype.writeInt16LE=function(t,e,n){return t=+t,e>>>=0,n||v(this,t,e,2,32767,-32768),r.TYPED_ARRAY_SUPPORT?(this[e]=t,this[e+1]=t>>>8):m(this,t,e,!0),e+2},r.prototype.writeInt16BE=function(t,e,n){return t=+t,e>>>=0,n||v(this,t,e,2,32767,-32768),r.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=t):m(this,t,e,!1),e+2},r.prototype.writeInt32LE=function(t,e,n){return t=+t,e>>>=0,n||v(this,t,e,4,2147483647,-2147483648),r.TYPED_ARRAY_SUPPORT?(this[e]=t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):y(this,t,e,!0),e+4},r.prototype.writeInt32BE=function(t,e,n){return t=+t,e>>>=0,n||v(this,t,e,4,2147483647,-2147483648),0>t&&(t=4294967295+t+1),r.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=t):y(this,t,e,!1),e+4},r.prototype.writeFloatLE=function(t,e,n){return b(this,t,e,!0,n)},r.prototype.writeFloatBE=function(t,e,n){return b(this,t,e,!1,n)},r.prototype.writeDoubleLE=function(t,e,n){return O(this,t,e,!0,n)},r.prototype.writeDoubleBE=function(t,e,n){return O(this,t,e,!1,n)},r.prototype.copy=function(t,e,n,i){var o=this;if(n||(n=0),i||0===i||(i=this.length),e||(e=0),i!==n&&0!==t.length&&0!==o.length){if(n>i)throw new TypeError("sourceEnd < sourceStart");if(0>e||e>=t.length)throw new TypeError("targetStart out of bounds");if(0>n||n>=o.length)throw new TypeError("sourceStart out of bounds");if(0>i||i>o.length)throw new TypeError("sourceEnd out of bounds");i>this.length&&(i=this.length),i-n>t.length-e&&(i=t.length-e+n);var s=i-n;if(100>s||!r.TYPED_ARRAY_SUPPORT)for(var a=0;s>a;a++)t[a+e]=this[a+n];else t._set(this.subarray(n,n+s),e)}},r.prototype.fill=function(t,e,n){if(t||(t=0),e||(e=0),n||(n=this.length),e>n)throw new TypeError("end < start");if(n!==e&&0!==this.length){if(0>e||e>=this.length)throw new TypeError("start out of bounds");if(0>n||n>this.length)throw new TypeError("end out of bounds");var r;if("number"==typeof t)for(r=e;n>r;r++)this[r]=t;else{var i=R(""+t),o=i.length;for(r=e;n>r;r++)this[r]=i[r%o]}return this}},r.prototype.toArrayBuffer=function(){if("undefined"!=typeof Uint8Array){if(r.TYPED_ARRAY_SUPPORT)return new r(this).buffer;for(var t=new Uint8Array(this.length),e=0,n=t.length;n>e;e+=1)t[e]=this[e];return t.buffer}throw new TypeError("Buffer.toArrayBuffer not supported in this browser")};var F=r.prototype;r._augment=function(t){return t._isBuffer=!0,t._get=t.get,t._set=t.set,t.get=F.get,t.set=F.set,t.write=F.write,t.toString=F.toString,t.toLocaleString=F.toString,t.toJSON=F.toJSON,t.equals=F.equals,t.compare=F.compare,t.copy=F.copy,t.slice=F.slice,t.readUInt8=F.readUInt8,t.readUInt16LE=F.readUInt16LE,t.readUInt16BE=F.readUInt16BE,t.readUInt32LE=F.readUInt32LE,t.readUInt32BE=F.readUInt32BE,t.readInt8=F.readInt8,t.readInt16LE=F.readInt16LE,t.readInt16BE=F.readInt16BE,t.readInt32LE=F.readInt32LE,t.readInt32BE=F.readInt32BE,t.readFloatLE=F.readFloatLE,t.readFloatBE=F.readFloatBE,t.readDoubleLE=F.readDoubleLE,t.readDoubleBE=F.readDoubleBE,t.writeUInt8=F.writeUInt8,t.writeUInt16LE=F.writeUInt16LE,t.writeUInt16BE=F.writeUInt16BE,t.writeUInt32LE=F.writeUInt32LE,t.writeUInt32BE=F.writeUInt32BE,t.writeInt8=F.writeInt8,t.writeInt16LE=F.writeInt16LE,t.writeInt16BE=F.writeInt16BE,t.writeInt32LE=F.writeInt32LE,t.writeInt32BE=F.writeInt32BE,t.writeFloatLE=F.writeFloatLE,t.writeFloatBE=F.writeFloatBE,t.writeDoubleLE=F.writeDoubleLE,t.writeDoubleBE=F.writeDoubleBE,t.fill=F.fill,t.inspect=F.inspect,t.toArrayBuffer=F.toArrayBuffer,t};var C=/[^+\/0-9A-z]/g},{"base64-js":7,ieee754:8,"is-array":9}],7:[function(t,e,n){var r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";(function(t){"use strict";function e(t){var e=t.charCodeAt(0);return e===s?62:e===a?63:u>e?-1:u+10>e?e-u+26+26:f+26>e?e-f:c+26>e?e-c+26:void 0}function n(t){function n(t){c[l++]=t}var r,i,s,a,u,c;if(t.length%4>0)throw Error("Invalid string. Length must be a multiple of 4");var f=t.length;u="="===t.charAt(f-2)?2:"="===t.charAt(f-1)?1:0,c=new o(3*t.length/4-u),s=u>0?t.length-4:t.length;var l=0;for(r=0,i=0;s>r;r+=4,i+=3)a=e(t.charAt(r))<<18|e(t.charAt(r+1))<<12|e(t.charAt(r+2))<<6|e(t.charAt(r+3)),n((16711680&a)>>16),n((65280&a)>>8),n(255&a);return 2===u?(a=e(t.charAt(r))<<2|e(t.charAt(r+1))>>4,n(255&a)):1===u&&(a=e(t.charAt(r))<<10|e(t.charAt(r+1))<<4|e(t.charAt(r+2))>>2,n(255&a>>8),n(255&a)),c}function i(t){function e(t){return r.charAt(t)}function n(t){return e(63&t>>18)+e(63&t>>12)+e(63&t>>6)+e(63&t)}var i,o,s,a=t.length%3,u="";for(i=0,s=t.length-a;s>i;i+=3)o=(t[i]<<16)+(t[i+1]<<8)+t[i+2],u+=n(o);switch(a){case 1:o=t[t.length-1],u+=e(o>>2),u+=e(63&o<<4),u+="==";break;case 2:o=(t[t.length-2]<<8)+t[t.length-1],u+=e(o>>10),u+=e(63&o>>4),u+=e(63&o<<2),u+="="}return u}var o="undefined"!=typeof Uint8Array?Uint8Array:Array,s="+".charCodeAt(0),a="/".charCodeAt(0),u="0".charCodeAt(0),c="a".charCodeAt(0),f="A".charCodeAt(0);t.toByteArray=n,t.fromByteArray=i})(n===void 0?this.base64js={}:n)},{}],8:[function(t,e,n){n.read=function(t,e,n,r,i){var o,s,a=8*i-r-1,u=(1<<a)-1,c=u>>1,f=-7,l=n?i-1:0,d=n?-1:1,p=t[e+l];for(l+=d,o=p&(1<<-f)-1,p>>=-f,f+=a;f>0;o=256*o+t[e+l],l+=d,f-=8);for(s=o&(1<<-f)-1,o>>=-f,f+=r;f>0;s=256*s+t[e+l],l+=d,f-=8);if(0===o)o=1-c;else{if(o===u)return s?0/0:1/0*(p?-1:1);s+=Math.pow(2,r),o-=c}return(p?-1:1)*s*Math.pow(2,o-r)},n.write=function(t,e,n,r,i,o){var s,a,u,c=8*o-i-1,f=(1<<c)-1,l=f>>1,d=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,p=r?0:o-1,h=r?1:-1,g=0>e||0===e&&0>1/e?1:0;for(e=Math.abs(e),isNaN(e)||1/0===e?(a=isNaN(e)?1:0,s=f):(s=Math.floor(Math.log(e)/Math.LN2),1>e*(u=Math.pow(2,-s))&&(s--,u*=2),e+=s+l>=1?d/u:d*Math.pow(2,1-l),e*u>=2&&(s++,u/=2),s+l>=f?(a=0,s=f):s+l>=1?(a=(e*u-1)*Math.pow(2,i),s+=l):(a=e*Math.pow(2,l-1)*Math.pow(2,i),s=0));i>=8;t[n+p]=255&a,p+=h,a/=256,i-=8);for(s=s<<i|a,c+=i;c>0;t[n+p]=255&s,p+=h,s/=256,c-=8);t[n+p-h]|=128*g}},{}],9:[function(t,e){var n=Array.isArray,r=Object.prototype.toString;e.exports=n||function(t){return!!t&&"[object Array]"==r.call(t)}},{}],10:[function(t,e){function n(){}var r=e.exports={};r.nextTick=function(){var t="undefined"!=typeof window&&window.setImmediate,e="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(t)return function(t){return window.setImmediate(t)};if(e){var n=[];return window.addEventListener("message",function(t){var e=t.source;if((e===window||null===e)&&"process-tick"===t.data&&(t.stopPropagation(),n.length>0)){var r=n.shift();r()}},!0),function(t){n.push(t),window.postMessage("process-tick","*")}}return function(t){setTimeout(t,0)}}(),r.title="browser",r.browser=!0,r.env={},r.argv=[],r.on=n,r.addListener=n,r.once=n,r.off=n,r.removeListener=n,r.removeAllListeners=n,r.emit=n,r.binding=function(){throw Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(){throw Error("process.chdir is not supported")}},{}],11:[function(t,e){(function(t){function n(e,n,r){return e instanceof ArrayBuffer&&(e=new Uint8Array(e)),new t(e,n,r)}n.prototype=Object.create(t.prototype),n.prototype.constructor=n,Object.keys(t).forEach(function(e){t.hasOwnProperty(e)&&(n[e]=t[e])}),e.exports=n}).call(this,t("buffer").Buffer)},{buffer:6}],12:[function(t,e){var n="READ",r="WRITE",i="CREATE",o="EXCLUSIVE",s="TRUNCATE",a="APPEND",u="CREATE",c="REPLACE";e.exports={FILE_SYSTEM_NAME:"local",FILE_STORE_NAME:"files",IDB_RO:"readonly",IDB_RW:"readwrite",WSQL_VERSION:"1",WSQL_SIZE:5242880,WSQL_DESC:"FileSystem Storage",MODE_FILE:"FILE",MODE_DIRECTORY:"DIRECTORY",MODE_SYMBOLIC_LINK:"SYMLINK",MODE_META:"META",SYMLOOP_MAX:10,BINARY_MIME_TYPE:"application/octet-stream",JSON_MIME_TYPE:"application/json",ROOT_DIRECTORY_NAME:"/",FS_FORMAT:"FORMAT",FS_NOCTIME:"NOCTIME",FS_NOMTIME:"NOMTIME",FS_NODUPEIDCHECK:"FS_NODUPEIDCHECK",O_READ:n,O_WRITE:r,O_CREATE:i,O_EXCLUSIVE:o,O_TRUNCATE:s,O_APPEND:a,O_FLAGS:{r:[n],"r+":[n,r],w:[r,i,s],"w+":[r,n,i,s],wx:[r,i,o,s],"wx+":[r,n,i,o,s],a:[r,i,a],"a+":[r,n,i,a],ax:[r,i,o,a],"ax+":[r,n,i,o,a]},XATTR_CREATE:u,XATTR_REPLACE:c,FS_READY:"READY",FS_PENDING:"PENDING",FS_ERROR:"ERROR",SUPER_NODE_ID:"00000000-0000-0000-0000-000000000000",STDIN:0,STDOUT:1,STDERR:2,FIRST_DESCRIPTOR:3,ENVIRONMENT:{TMP:"/tmp",PATH:""}}},{}],13:[function(t,e){var n=t("./constants.js").MODE_FILE;e.exports=function(t,e){this.id=t,this.type=e||n}},{"./constants.js":12}],14:[function(t,e){(function(t){function n(t){return t.toString("utf8")}function r(e){return new t(e,"utf8")}e.exports={encode:r,decode:n}}).call(this,t("buffer").Buffer)},{buffer:6}],15:[function(t,e){var n={};["9:EBADF:bad file descriptor","10:EBUSY:resource busy or locked","18:EINVAL:invalid argument","27:ENOTDIR:not a directory","28:EISDIR:illegal operation on a directory","34:ENOENT:no such file or directory","47:EEXIST:file already exists","50:EPERM:operation not permitted","51:ELOOP:too many symbolic links encountered","53:ENOTEMPTY:directory not empty","55:EIO:i/o error","1000:ENOTMOUNTED:not mounted","1001:EFILESYSTEMERROR:missing super node, use 'FORMAT' flag to format filesystem.","1002:ENOATTR:attribute does not exist"].forEach(function(t){function e(t,e){Error.call(this),this.name=i,this.code=i,this.errno=r,this.message=t||o,e&&(this.path=e),this.stack=Error(this.message).stack}t=t.split(":");var r=+t[0],i=t[1],o=t[2];e.prototype=Object.create(Error.prototype),e.prototype.constructor=e,e.prototype.toString=function(){var t=this.path?", '"+this.path+"'":"";return this.name+": "+this.message+t},n[i]=n[r]=e}),e.exports=n},{}],16:[function(t,e){function n(t,e,n,r,i){function o(n){t.changes.push({event:"change",path:e}),i(n)}var s=t.flags;le(s).contains(Pe)&&delete r.ctime,le(s).contains(Be)&&delete r.mtime;var a=!1;r.ctime&&(n.ctime=r.ctime,n.atime=r.ctime,a=!0),r.atime&&(n.atime=r.atime,a=!0),r.mtime&&(n.mtime=r.mtime,a=!0),a?t.putObject(n.id,n,o):o()}function r(t,e,r,o){function s(n,r){n?o(n):r.mode!==we?o(new Fe.ENOTDIR("a component of the path prefix is not a directory",e)):(l=r,i(t,e,a))}function a(n,r){!n&&r?o(new Fe.EEXIST("path name already exists",e)):!n||n instanceof Fe.ENOENT?t.getObject(l.data,u):o(n)}function u(e,n){e?o(e):(d=n,Ye.create({guid:t.guid,mode:r},function(e,n){return e?(o(e),void 0):(p=n,p.nlinks+=1,t.putObject(p.id,p,f),void 0)}))}function c(e){if(e)o(e);else{var r=Date.now();n(t,g,p,{mtime:r,ctime:r},o)}}function f(e){e?o(e):(d[h]=new Ce(p.id,r),t.putObject(l.data,d,c))}if(r!==we&&r!==ye)return o(new Fe.EINVAL("mode must be a directory or file",e));e=pe(e);var l,d,p,h=ge(e),g=he(e);i(t,g,s)}function i(t,e,n){function r(e,r){e?n(e):r&&r.mode===Oe&&r.rnode?t.getObject(r.rnode,o):n(new Fe.EFILESYSTEMERROR)}function o(t,e){t?n(t):e?n(null,e):n(new Fe.ENOENT)}function s(r,i){r?n(r):i.mode===we&&i.data?t.getObject(i.data,a):n(new Fe.ENOTDIR("a component of the path prefix is not a directory",e))}function a(r,i){if(r)n(r);else if(le(i).has(f)){var o=i[f].id;t.getObject(o,u)}else n(new Fe.ENOENT(null,e))}function u(t,r){t?n(t):r.mode==be?(d++,d>Ae?n(new Fe.ELOOP(null,e)):c(r.data)):n(null,r)}function c(e){e=pe(e),l=he(e),f=ge(e),Ie==f?t.getObject(Te,r):i(t,l,s)}if(e=pe(e),!e)return n(new Fe.ENOENT("path is an empty string"));var f=ge(e),l=he(e),d=0;Ie==f?t.getObject(Te,r):i(t,l,s)}function o(t,e,r,o,s,a){function u(i,u){function f(e){e?a(e):n(t,c,u,{ctime:Date.now()},a)}u?u.xattrs[r]:null,i?a(i):s===Ne&&u.xattrs.hasOwnProperty(r)?a(new Fe.EEXIST("attribute already exists",e)):s!==Le||u.xattrs.hasOwnProperty(r)?(u.xattrs[r]=o,t.putObject(u.id,u,f)):a(new Fe.ENOATTR(null,e))}var c;"string"==typeof e?(c=e,i(t,e,u)):"object"==typeof e&&"string"==typeof e.id?(c=e.path,t.getObject(e.id,u)):a(new Fe.EINVAL("path or file descriptor of wrong type",e))}function s(t,e){function n(n,i){!n&&i?e():!n||n instanceof Fe.ENOENT?ke.create({guid:t.guid},function(n,i){return n?(e(n),void 0):(o=i,t.putObject(o.id,o,r),void 0)}):e(n)}function r(n){n?e(n):Ye.create({guid:t.guid,id:o.rnode,mode:we},function(n,r){return n?(e(n),void 0):(s=r,s.nlinks+=1,t.putObject(s.id,s,i),void 0)})}function i(n){n?e(n):(a={},t.putObject(s.data,a,e))}var o,s,a;t.getObject(Te,n)}function a(t,e,r){function o(n,o){!n&&o?r(new Fe.EEXIST(null,e)):!n||n instanceof Fe.ENOENT?i(t,E,s):r(n)}function s(e,n){e?r(e):(p=n,t.getObject(p.data,a))}function a(e,n){e?r(e):(h=n,Ye.create({guid:t.guid,mode:we},function(e,n){return e?(r(e),void 0):(l=n,l.nlinks+=1,t.putObject(l.id,l,u),void 0)}))}function u(e){e?r(e):(d={},t.putObject(l.data,d,f))}function c(e){if(e)r(e);else{var i=Date.now();n(t,E,p,{mtime:i,ctime:i},r)}}function f(e){e?r(e):(h[g]=new Ce(l.id,we),t.putObject(p.data,h,c))}e=pe(e);var l,d,p,h,g=ge(e),E=he(e);i(t,e,o)}function u(t,e,r){function o(e,n){e?r(e):(g=n,t.getObject(g.data,s))}function s(n,i){n?r(n):Ie==v?r(new Fe.EBUSY(null,e)):le(i).has(v)?(E=i,p=E[v].id,t.getObject(p,a)):r(new Fe.ENOENT(null,e))}function a(n,i){n?r(n):i.mode!=we?r(new Fe.ENOTDIR(null,e)):(p=i,t.getObject(p.data,u))}function u(t,n){t?r(t):(h=n,le(h).size()>0?r(new Fe.ENOTEMPTY(null,e)):f())}function c(e){if(e)r(e);else{var i=Date.now();n(t,m,g,{mtime:i,ctime:i},l)}}function f(){delete E[v],t.putObject(g.data,E,c)}function l(e){e?r(e):t.delete(p.id,d)}function d(e){e?r(e):t.delete(p.data,r)}e=pe(e);var p,h,g,E,v=ge(e),m=he(e);i(t,m,o)}function c(t,e,r,o){function s(n,r){n?o(n):r.mode!==we?o(new Fe.ENOENT(null,e)):(E=r,t.getObject(E.data,a))}function a(n,i){n?o(n):(v=i,le(v).has(b)?le(r).contains(_e)?o(new Fe.ENOENT("O_CREATE and O_EXCLUSIVE are set, and the named file exists",e)):(m=v[b],m.type==we&&le(r).contains(Re)?o(new Fe.EISDIR("the named file is a directory and O_WRITE is set",e)):t.getObject(m.id,u)):le(r).contains(Se)?l():o(new Fe.ENOENT("O_CREATE is not set and the named file does not exist",e)))}function u(t,n){if(t)o(t);else{var r=n;r.mode==be?(I++,I>Ae?o(new Fe.ELOOP(null,e)):c(r.data)):f(void 0,r)}}function c(n){n=pe(n),O=he(n),b=ge(n),Ie==b&&(le(r).contains(Re)?o(new Fe.EISDIR("the named file is a directory and O_WRITE is set",e)):i(t,e,f)),i(t,O,s)}function f(t,e){t?o(t):(y=e,o(null,y))}function l(){Ye.create({guid:t.guid,mode:ye},function(e,n){return e?(o(e),void 0):(y=n,y.nlinks+=1,t.putObject(y.id,y,d),void 0)
})}function d(e){e?o(e):(w=new Xe(0),w.fill(0),t.putBuffer(y.data,w,h))}function p(e){if(e)o(e);else{var r=Date.now();n(t,O,E,{mtime:r,ctime:r},g)}}function h(e){e?o(e):(v[b]=new Ce(y.id,ye),t.putObject(E.data,v,p))}function g(t){t?o(t):o(null,y)}e=pe(e);var E,v,m,y,w,b=ge(e),O=he(e),I=0;Ie==b?le(r).contains(Re)?o(new Fe.EISDIR("the named file is a directory and O_WRITE is set",e)):i(t,e,f):i(t,O,s)}function f(t,e,r,i,o,s){function a(t){t?s(t):s(null,o)}function u(r){if(r)s(r);else{var i=Date.now();n(t,e.path,l,{mtime:i,ctime:i},a)}}function c(e){e?s(e):t.putObject(l.id,l,u)}function f(n,a){if(n)s(n);else{l=a;var u=new Xe(o);u.fill(0),r.copy(u,0,i,i+o),e.position=o,l.size=o,l.version+=1,t.putBuffer(l.data,u,c)}}var l;t.getObject(e.id,f)}function l(t,e,r,i,o,s,a){function u(t){t?a(t):a(null,o)}function c(r){if(r)a(r);else{var i=Date.now();n(t,e.path,p,{mtime:i,ctime:i},u)}}function f(e){e?a(e):t.putObject(p.id,p,c)}function l(n,u){if(n)a(n);else{if(h=u,!h)return a(new Fe.EIO("Expected Buffer"));var c=void 0!==s&&null!==s?s:e.position,l=Math.max(h.length,c+o),d=new Xe(l);d.fill(0),h&&h.copy(d),r.copy(d,c,i,i+o),void 0===s&&(e.position+=o),p.size=l,p.version+=1,t.putBuffer(p.data,d,f)}}function d(e,n){e?a(e):(p=n,t.getBuffer(p.data,l))}var p,h;t.getObject(e.id,d)}function d(t,e,n,r,i,o,s){function a(t,a){if(t)s(t);else{if(f=a,!f)return s(new Fe.EIO("Expected Buffer"));var u=void 0!==o&&null!==o?o:e.position;i=u+i>n.length?i-u:i,f.copy(n,r,u,u+i),void 0===o&&(e.position+=i),s(null,i)}}function u(e,n){e?s(e):(c=n,t.getBuffer(c.data,a))}var c,f;t.getObject(e.id,u)}function p(t,e,n){e=pe(e),ge(e),i(t,e,n)}function h(t,e,n){t.getObject(e.id,n)}function g(t,e,n){function r(e,r){e?n(e):(s=r,t.getObject(s.data,o))}function o(r,i){r?n(r):(a=i,le(a).has(u)?t.getObject(a[u].id,n):n(new Fe.ENOENT("a component of the path does not name an existing file",e)))}e=pe(e);var s,a,u=ge(e),c=he(e);Ie==u?i(t,e,n):i(t,c,r)}function E(t,e,r,o){function s(e){e?o(e):n(t,r,y,{ctime:Date.now()},o)}function a(e,n){e?o(e):(y=n,y.nlinks+=1,t.putObject(y.id,y,s))}function u(e){e?o(e):t.getObject(m[w].id,a)}function c(e,n){e?o(e):(m=n,le(m).has(w)?o(new Fe.EEXIST("newpath resolves to an existing file",w)):(m[w]=E[p],t.putObject(v.data,m,u)))}function f(e,n){e?o(e):(v=n,t.getObject(v.data,c))}function l(e,n){e?o(e):(E=n,le(E).has(p)?i(t,b,f):o(new Fe.ENOENT("a component of either path prefix does not exist",p)))}function d(e,n){e?o(e):(g=n,t.getObject(g.data,l))}e=pe(e);var p=ge(e),h=he(e);r=pe(r);var g,E,v,m,y,w=ge(r),b=he(r);i(t,h,d)}function v(t,e,r){function o(e){e?r(e):(delete d[h],t.putObject(l.data,d,function(){var e=Date.now();n(t,g,l,{mtime:e,ctime:e},r)}))}function s(e){e?r(e):t.delete(p.data,o)}function a(i,a){i?r(i):(p=a,p.nlinks-=1,1>p.nlinks?t.delete(p.id,s):t.putObject(p.id,p,function(){n(t,e,p,{ctime:Date.now()},o)}))}function u(t,e){t?r(t):"DIRECTORY"===e.mode?r(new Fe.EPERM("unlink not permitted on directories",h)):a(null,e)}function c(e,n){e?r(e):(d=n,le(d).has(h)?t.getObject(d[h].id,u):r(new Fe.ENOENT("a component of the path does not name an existing file",h)))}function f(e,n){e?r(e):(l=n,t.getObject(l.data,c))}e=pe(e);var l,d,p,h=ge(e),g=he(e);i(t,g,f)}function m(t,e,n){function r(t,e){if(t)n(t);else{a=e;var r=Object.keys(a);n(null,r)}}function o(i,o){i?n(i):o.mode!==we?n(new Fe.ENOTDIR(null,e)):(s=o,t.getObject(s.data,r))}e=pe(e),ge(e);var s,a;i(t,e,o)}function y(t,e,r,o){function s(e,n){e?o(e):(l=n,t.getObject(l.data,a))}function a(t,e){t?o(t):(d=e,le(d).has(h)?o(new Fe.EEXIST(null,h)):u())}function u(){Ye.create({guid:t.guid,mode:be},function(n,r){return n?(o(n),void 0):(p=r,p.nlinks+=1,p.size=e.length,p.data=e,t.putObject(p.id,p,f),void 0)})}function c(e){if(e)o(e);else{var r=Date.now();n(t,g,l,{mtime:r,ctime:r},o)}}function f(e){e?o(e):(d[h]=new Ce(p.id,be),t.putObject(l.data,d,c))}r=pe(r);var l,d,p,h=ge(r),g=he(r);Ie==h?o(new Fe.EEXIST(null,h)):i(t,g,s)}function w(t,e,n){function r(e,r){e?n(e):(a=r,t.getObject(a.data,o))}function o(e,r){e?n(e):(u=r,le(u).has(c)?t.getObject(u[c].id,s):n(new Fe.ENOENT("a component of the path does not name an existing file",c)))}function s(t,r){t?n(t):r.mode!=be?n(new Fe.EINVAL("path not a symbolic link",e)):n(null,r.data)}e=pe(e);var a,u,c=ge(e),f=he(e);i(t,f,r)}function b(t,e,r,o){function s(n,r){n?o(n):r.mode==we?o(new Fe.EISDIR(null,e)):(f=r,t.getBuffer(f.data,a))}function a(e,n){if(e)o(e);else{if(!n)return o(new Fe.EIO("Expected Buffer"));var i=new Xe(r);i.fill(0),n&&n.copy(i),t.putBuffer(f.data,i,c)}}function u(r){if(r)o(r);else{var i=Date.now();n(t,e,f,{mtime:i,ctime:i},o)}}function c(e){e?o(e):(f.size=r,f.version+=1,t.putObject(f.id,f,u))}e=pe(e);var f;0>r?o(new Fe.EINVAL("length cannot be negative")):i(t,e,s)}function O(t,e,r,i){function o(e,n){e?i(e):n.mode==we?i(new Fe.EISDIR):(c=n,t.getBuffer(c.data,s))}function s(e,n){if(e)i(e);else{var o;if(!n)return i(new Fe.EIO("Expected Buffer"));n?o=n.slice(0,r):(o=new Xe(r),o.fill(0)),t.putBuffer(c.data,o,u)}}function a(r){if(r)i(r);else{var o=Date.now();n(t,e.path,c,{mtime:o,ctime:o},i)}}function u(e){e?i(e):(c.size=r,c.version+=1,t.putObject(c.id,c,a))}var c;0>r?i(new Fe.EINVAL("length cannot be negative")):t.getObject(e.id,o)}function I(t,e,r,o,s){function a(i,a){i?s(i):n(t,e,a,{atime:r,ctime:o,mtime:o},s)}e=pe(e),"number"!=typeof r||"number"!=typeof o?s(new Fe.EINVAL("atime and mtime must be number",e)):0>r||0>o?s(new Fe.EINVAL("atime and mtime must be positive integers",e)):i(t,e,a)}function T(t,e,r,i,o){function s(s,a){s?o(s):n(t,e.path,a,{atime:r,ctime:i,mtime:i},o)}"number"!=typeof r||"number"!=typeof i?o(new Fe.EINVAL("atime and mtime must be a number")):0>r||0>i?o(new Fe.EINVAL("atime and mtime must be positive integers")):t.getObject(e.id,s)}function A(t,e,n,r,i,s){e=pe(e),"string"!=typeof n?s(new Fe.EINVAL("attribute name must be a string",e)):n?null!==i&&i!==Ne&&i!==Le?s(new Fe.EINVAL("invalid flag, must be null, XATTR_CREATE or XATTR_REPLACE",e)):o(t,e,n,r,i,s):s(new Fe.EINVAL("attribute name cannot be an empty string",e))}function j(t,e,n,r,i,s){"string"!=typeof n?s(new Fe.EINVAL("attribute name must be a string")):n?null!==i&&i!==Ne&&i!==Le?s(new Fe.EINVAL("invalid flag, must be null, XATTR_CREATE or XATTR_REPLACE")):o(t,e,n,r,i,s):s(new Fe.EINVAL("attribute name cannot be an empty string"))}function R(t,e,n,r){function o(t,i){i?i.xattrs[n]:null,t?r(t):i.xattrs.hasOwnProperty(n)?r(null,i.xattrs[n]):r(new Fe.ENOATTR(null,e))}e=pe(e),"string"!=typeof n?r(new Fe.EINVAL("attribute name must be a string",e)):n?i(t,e,o):r(new Fe.EINVAL("attribute name cannot be an empty string",e))}function S(t,e,n,r){function i(t,e){e?e.xattrs[n]:null,t?r(t):e.xattrs.hasOwnProperty(n)?r(null,e.xattrs[n]):r(new Fe.ENOATTR)}"string"!=typeof n?r(new Fe.EINVAL):n?t.getObject(e.id,i):r(new Fe.EINVAL("attribute name cannot be an empty string"))}function _(t,e,r,o){function s(i,s){function a(r){r?o(r):n(t,e,s,{ctime:Date.now()},o)}var u=s?s.xattrs:null;i?o(i):u.hasOwnProperty(r)?(delete s.xattrs[r],t.putObject(s.id,s,a)):o(new Fe.ENOATTR(null,e))}e=pe(e),"string"!=typeof r?o(new Fe.EINVAL("attribute name must be a string",e)):r?i(t,e,s):o(new Fe.EINVAL("attribute name cannot be an empty string",e))}function x(t,e,r,i){function o(o,s){function a(r){r?i(r):n(t,e.path,s,{ctime:Date.now()},i)}o?i(o):s.xattrs.hasOwnProperty(r)?(delete s.xattrs[r],t.putObject(s.id,s,a)):i(new Fe.ENOATTR)}"string"!=typeof r?i(new Fe.EINVAL("attribute name must be a string")):r?t.getObject(e.id,o):i(new Fe.EINVAL("attribute name cannot be an empty string"))}function D(t){return le(De).has(t)?De[t]:null}function N(t,e,n){return t?"function"==typeof t?t={encoding:e,flag:n}:"string"==typeof t&&(t={encoding:t,flag:n}):t={encoding:e,flag:n},t}function L(t,e){var n;return t?ve(t)?n=new Fe.EINVAL("Path must be a string without null bytes.",t):Ee(t)||(n=new Fe.EINVAL("Path must be absolute.",t)):n=new Fe.EINVAL("Path must be a string",t),n?(e(n),!1):!0}function B(t,e,n,r,i,o){function s(e,i){if(e)o(e);else{var s;s=le(r).contains(xe)?i.size:0;var a=new Ue(n,i.id,r,s),u=t.allocDescriptor(a);o(null,u)}}o=arguments[arguments.length-1],L(n,o)&&(r=D(r),r||o(new Fe.EINVAL("flags is not valid"),n),c(e,n,r,s))}function P(t,e,n,r){le(t.openFiles).has(n)?(t.releaseDescriptor(n),r(null)):r(new Fe.EBADF)}function M(t,e,n,i,o){L(n,o)&&r(e,n,i,o)}function F(t,e,n,r,i){i=arguments[arguments.length-1],L(n,i)&&a(e,n,i)}function C(t,e,n,r){L(n,r)&&u(e,n,r)}function U(t,e,n,r){function i(e,n){if(e)r(e);else{var i=new Ve(n,t.name);r(null,i)}}L(n,r)&&p(e,n,i)}function k(t,e,n,r){function i(e,n){if(e)r(e);else{var i=new Ve(n,t.name);r(null,i)}}var o=t.openFiles[n];o?h(e,o,i):r(new Fe.EBADF)}function Y(t,e,n,r,i){L(n,i)&&L(r,i)&&E(e,n,r,i)}function V(t,e,n,r){L(n,r)&&v(e,n,r)}function X(t,e,n,r,i,o,s,a){function u(t,e){a(t,e||0,r)}i=void 0===i?0:i,o=void 0===o?r.length-i:o,a=arguments[arguments.length-1];var c=t.openFiles[n];c?le(c.flags).contains(je)?d(e,c,r,i,o,s,u):a(new Fe.EBADF("descriptor does not permit reading")):a(new Fe.EBADF)}function W(t,e,n,r,i){if(i=arguments[arguments.length-1],r=N(r,null,"r"),L(n,i)){var o=D(r.flag||"r");return o?(c(e,n,o,function(s,a){function u(){t.releaseDescriptor(f)}if(s)return i(s);var c=new Ue(n,a.id,o,0),f=t.allocDescriptor(c);h(e,c,function(o,s){if(o)return u(),i(o);var a=new Ve(s,t.name);if(a.isDirectory())return u(),i(new Fe.EISDIR("illegal operation on directory",n));var f=a.size,l=new Xe(f);l.fill(0),d(e,c,l,0,f,0,function(t){if(u(),t)return i(t);var e;e="utf8"===r.encoding?Me.decode(l):l,i(null,e)})})}),void 0):i(new Fe.EINVAL("flags is not valid",n))}}function z(t,e,n,r,i,o,s,a){a=arguments[arguments.length-1],i=void 0===i?0:i,o=void 0===o?r.length-i:o;var u=t.openFiles[n];u?le(u.flags).contains(Re)?o>r.length-i?a(new Fe.EIO("intput buffer is too small")):l(e,u,r,i,o,s,a):a(new Fe.EBADF("descriptor does not permit writing")):a(new Fe.EBADF)}function q(t,e,n,r,i,o){if(o=arguments[arguments.length-1],i=N(i,"utf8","w"),L(n,o)){var s=D(i.flag||"w");if(!s)return o(new Fe.EINVAL("flags is not valid",n));r=r||"","number"==typeof r&&(r=""+r),"string"==typeof r&&"utf8"===i.encoding&&(r=Me.encode(r)),c(e,n,s,function(i,a){if(i)return o(i);var u=new Ue(n,a.id,s,0),c=t.allocDescriptor(u);f(e,u,r,0,r.length,function(e){return t.releaseDescriptor(c),e?o(e):(o(null),void 0)})})}}function J(t,e,n,r,i,o){if(o=arguments[arguments.length-1],i=N(i,"utf8","a"),L(n,o)){var s=D(i.flag||"a");if(!s)return o(new Fe.EINVAL("flags is not valid",n));r=r||"","number"==typeof r&&(r=""+r),"string"==typeof r&&"utf8"===i.encoding&&(r=Me.encode(r)),c(e,n,s,function(i,a){if(i)return o(i);var u=new Ue(n,a.id,s,a.size),c=t.allocDescriptor(u);l(e,u,r,0,r.length,u.position,function(e){return t.releaseDescriptor(c),e?o(e):(o(null),void 0)})})}}function Q(t,e,n,r){function i(t){r(t?!1:!0)}U(t,e,n,i)}function H(t,e,n,r,i){L(n,i)&&R(e,n,r,i)}function K(t,e,n,r,i){var o=t.openFiles[n];o?S(e,o,r,i):i(new Fe.EBADF)}function G(t,e,n,r,i,o,s){"function"==typeof o&&(s=o,o=null),L(n,s)&&A(e,n,r,i,o,s)}function $(t,e,n,r,i,o,s){"function"==typeof o&&(s=o,o=null);var a=t.openFiles[n];a?le(a.flags).contains(Re)?j(e,a,r,i,o,s):s(new Fe.EBADF("descriptor does not permit writing")):s(new Fe.EBADF)}function Z(t,e,n,r,i){L(n,i)&&_(e,n,r,i)}function te(t,e,n,r,i){var o=t.openFiles[n];o?le(o.flags).contains(Re)?x(e,o,r,i):i(new Fe.EBADF("descriptor does not permit writing")):i(new Fe.EBADF)}function ee(t,e,n,r,i,o){function s(t,e){t?o(t):0>e.size+r?o(new Fe.EINVAL("resulting file offset would be negative")):(a.position=e.size+r,o(null,a.position))}var a=t.openFiles[n];a||o(new Fe.EBADF),"SET"===i?0>r?o(new Fe.EINVAL("resulting file offset would be negative")):(a.position=r,o(null,a.position)):"CUR"===i?0>a.position+r?o(new Fe.EINVAL("resulting file offset would be negative")):(a.position+=r,o(null,a.position)):"END"===i?h(e,a,s):o(new Fe.EINVAL("whence argument is not a proper value"))}function ne(t,e,n,r){L(n,r)&&m(e,n,r)}function re(t,e,n,r,i,o){if(L(n,o)){var s=Date.now();r=r?r:s,i=i?i:s,I(e,n,r,i,o)}}function ie(t,e,n,r,i,o){var s=Date.now();r=r?r:s,i=i?i:s;var a=t.openFiles[n];a?le(a.flags).contains(Re)?T(e,a,r,i,o):o(new Fe.EBADF("descriptor does not permit writing")):o(new Fe.EBADF)}function oe(t,e,n,r,i){function o(t){t?i(t):v(e,n,i)}L(n,i)&&L(r,i)&&E(e,n,r,o)}function se(t,e,n,r,i,o){o=arguments[arguments.length-1],L(n,o)&&L(r,o)&&y(e,n,r,o)}function ae(t,e,n,r){L(n,r)&&w(e,n,r)}function ue(t,e,n,r){function i(e,n){if(e)r(e);else{var i=new Ve(n,t.name);r(null,i)}}L(n,r)&&g(e,n,i)}function ce(t,e,n,r,i){i=arguments[arguments.length-1],r=r||0,L(n,i)&&b(e,n,r,i)}function fe(t,e,n,r,i){i=arguments[arguments.length-1],r=r||0;var o=t.openFiles[n];o?le(o.flags).contains(Re)?O(e,o,r,i):i(new Fe.EBADF("descriptor does not permit writing")):i(new Fe.EBADF)}var le=t("../../lib/nodash.js"),de=t("../path.js"),pe=de.normalize,he=de.dirname,ge=de.basename,Ee=de.isAbsolute,ve=de.isNull,me=t("../constants.js"),ye=me.MODE_FILE,we=me.MODE_DIRECTORY,be=me.MODE_SYMBOLIC_LINK,Oe=me.MODE_META,Ie=me.ROOT_DIRECTORY_NAME,Te=me.SUPER_NODE_ID,Ae=me.SYMLOOP_MAX,je=me.O_READ,Re=me.O_WRITE,Se=me.O_CREATE,_e=me.O_EXCLUSIVE;me.O_TRUNCATE;var xe=me.O_APPEND,De=me.O_FLAGS,Ne=me.XATTR_CREATE,Le=me.XATTR_REPLACE,Be=me.FS_NOMTIME,Pe=me.FS_NOCTIME,Me=t("../encoding.js"),Fe=t("../errors.js"),Ce=t("../directory-entry.js"),Ue=t("../open-file-description.js"),ke=t("../super-node.js"),Ye=t("../node.js"),Ve=t("../stats.js"),Xe=t("../buffer.js");e.exports={ensureRootDirectory:s,open:B,close:P,mknod:M,mkdir:F,rmdir:C,unlink:V,stat:U,fstat:k,link:Y,read:X,readFile:W,write:z,writeFile:q,appendFile:J,exists:Q,getxattr:H,fgetxattr:K,setxattr:G,fsetxattr:$,removexattr:Z,fremovexattr:te,lseek:ee,readdir:ne,utimes:re,futimes:ie,rename:oe,symlink:se,readlink:ae,lstat:ue,truncate:ce,ftruncate:fe}},{"../../lib/nodash.js":4,"../buffer.js":11,"../constants.js":12,"../directory-entry.js":13,"../encoding.js":14,"../errors.js":15,"../node.js":20,"../open-file-description.js":21,"../path.js":22,"../stats.js":30,"../super-node.js":31}],17:[function(t,e){function n(t){return"function"==typeof t?t:function(t){if(t)throw t}}function r(t,e){function n(){N.forEach(function(t){t.call(this)}.bind(_)),N=null}function r(t){return function(e){function n(e){var r=A();t.getObject(r,function(t,i){return t?(e(t),void 0):(i?n(e):e(null,r),void 0)})}return i(g).contains(p)?(e(null,A()),void 0):(n(e),void 0)}}function a(t){if(t.length){var e=E.getInstance();t.forEach(function(t){e.emit(t.event,t.path)})}}t=t||{},e=e||s;var g=t.flags,A=t.guid?t.guid:y,j=t.provider||new h.Default(t.name||u),R=t.name||j.name,S=i(g).contains(c),_=this;_.readyState=l,_.name=R,_.error=null,_.stdin=w,_.stdout=b,_.stderr=O;var x={},D=I;Object.defineProperty(this,"openFiles",{get:function(){return x}}),this.allocDescriptor=function(t){var e=D++;return x[e]=t,e},this.releaseDescriptor=function(t){delete x[t]};var N=[];this.queueOrRun=function(t){var e;return f==_.readyState?t.call(_):d==_.readyState?e=new m.EFILESYSTEMERROR("unknown error"):N.push(t),e},this.watch=function(t,e,n){if(o(t))throw Error("Path must be a string without null bytes.");"function"==typeof e&&(n=e,e={}),e=e||{},n=n||s;var r=new v;return r.start(t,!1,e.recursive),r.on("change",n),r},j.open(function(t){function i(t){function i(t){var e=j[t]();return e.flags=g,e.changes=[],e.guid=r(e),e.close=function(){var t=e.changes;a(t),t.length=0},e}_.provider={openReadWriteContext:function(){return i("getReadWriteContext")},openReadOnlyContext:function(){return i("getReadOnlyContext")}},_.readyState=t?d:f,n(),e(t,_)}if(t)return i(t);var o=j.getReadWriteContext();o.guid=r(o),S?o.clear(function(t){return t?i(t):(T.ensureRootDirectory(o,i),void 0)}):T.ensureRootDirectory(o,i)})}var i=t("../../lib/nodash.js"),o=t("../path.js").isNull,s=t("../shared.js").nop,a=t("../constants.js"),u=a.FILE_SYSTEM_NAME,c=a.FS_FORMAT,f=a.FS_READY,l=a.FS_PENDING,d=a.FS_ERROR,p=a.FS_NODUPEIDCHECK,h=t("../providers/index.js"),g=t("../shell/shell.js"),E=t("../../lib/intercom.js"),v=t("../fs-watcher.js"),m=t("../errors.js"),y=t("../shared.js").guid,w=a.STDIN,b=a.STDOUT,O=a.STDERR,I=a.FIRST_DESCRIPTOR,T=t("./implementation.js");r.providers=h,["open","close","mknod","mkdir","rmdir","stat","fstat","link","unlink","read","readFile","write","writeFile","appendFile","exists","lseek","readdir","rename","readlink","symlink","lstat","truncate","ftruncate","utimes","futimes","setxattr","getxattr","fsetxattr","fgetxattr","removexattr","fremovexattr"].forEach(function(t){r.prototype[t]=function(){var e=this,r=Array.prototype.slice.call(arguments,0),i=r.length-1,o="function"!=typeof r[i],s=n(r[i]),a=e.queueOrRun(function(){function n(){a.close(),s.apply(e,arguments)}var a=e.provider.openReadWriteContext();if(d===e.readyState){var u=new m.EFILESYSTEMERROR("filesystem unavailable, operation canceled");return s.call(e,u)}o?r.push(n):r[i]=n;var c=[e,a].concat(r);T[t].apply(null,c)});a&&s(a)}}),r.prototype.Shell=function(t){return new g(this,t)},e.exports=r},{"../../lib/intercom.js":3,"../../lib/nodash.js":4,"../constants.js":12,"../errors.js":15,"../fs-watcher.js":18,"../path.js":22,"../providers/index.js":23,"../shared.js":27,"../shell/shell.js":29,"./implementation.js":16}],18:[function(t,e){function n(){function t(t){(n===t||a&&0===t.indexOf(e))&&s.trigger("change","change",t)}r.call(this);var e,n,s=this,a=!1;s.start=function(r,s,u){if(!n){if(i.isNull(r))throw Error("Path must be a string without null bytes.");n=i.normalize(r),a=u===!0,a&&(e="/"===n?"/":n+"/");var c=o.getInstance();c.on("change",t)}},s.close=function(){var e=o.getInstance();e.off("change",t),s.removeAllListeners("change")}}var r=t("../lib/eventemitter.js"),i=t("./path.js"),o=t("../lib/intercom.js");n.prototype=new r,n.prototype.constructor=n,e.exports=n},{"../lib/eventemitter.js":2,"../lib/intercom.js":3,"./path.js":22}],19:[function(t,e){e.exports={FileSystem:t("./filesystem/interface.js"),Buffer:t("./buffer.js"),Path:t("./path.js"),Errors:t("./errors.js")}},{"./buffer.js":11,"./errors.js":15,"./filesystem/interface.js":17,"./path.js":22}],20:[function(t,e){function n(t){var e=Date.now();this.id=t.id,this.mode=t.mode||i,this.size=t.size||0,this.atime=t.atime||e,this.ctime=t.ctime||e,this.mtime=t.mtime||e,this.flags=t.flags||[],this.xattrs=t.xattrs||{},this.nlinks=t.nlinks||0,this.version=t.version||0,this.blksize=void 0,this.nblocks=1,this.data=t.data}function r(t,e,n){t[e]?n(null):t.guid(function(r,i){t[e]=i,n(r)})}var i=t("./constants.js").MODE_FILE;n.create=function(t,e){r(t,"id",function(i){return i?(e(i),void 0):(r(t,"data",function(r){return r?(e(r),void 0):(e(null,new n(t)),void 0)}),void 0)})},e.exports=n},{"./constants.js":12}],21:[function(t,e){e.exports=function(t,e,n,r){this.path=t,this.id=e,this.flags=n,this.position=r}},{}],22:[function(t,e,n){function r(t,e){for(var n=0,r=t.length-1;r>=0;r--){var i=t[r];"."===i?t.splice(r,1):".."===i?(t.splice(r,1),n++):n&&(t.splice(r,1),n--)}if(e)for(;n--;n)t.unshift("..");return t}function i(){for(var t="",e=!1,n=arguments.length-1;n>=-1&&!e;n--){var i=n>=0?arguments[n]:"/";"string"==typeof i&&i&&(t=i+"/"+t,e="/"===i.charAt(0))}return t=r(t.split("/").filter(function(t){return!!t}),!e).join("/"),(e?"/":"")+t||"."}function o(t){var e="/"===t.charAt(0);return"/"===t.substr(-1),t=r(t.split("/").filter(function(t){return!!t}),!e).join("/"),t||e||(t="."),(e?"/":"")+t}function s(){var t=Array.prototype.slice.call(arguments,0);return o(t.filter(function(t){return t&&"string"==typeof t}).join("/"))}function a(t,e){function r(t){for(var e=0;t.length>e&&""===t[e];e++);for(var n=t.length-1;n>=0&&""===t[n];n--);return e>n?[]:t.slice(e,n-e+1)}t=n.resolve(t).substr(1),e=n.resolve(e).substr(1);for(var i=r(t.split("/")),o=r(e.split("/")),s=Math.min(i.length,o.length),a=s,u=0;s>u;u++)if(i[u]!==o[u]){a=u;break}for(var c=[],u=a;i.length>u;u++)c.push("..");return c=c.concat(o.slice(a)),c.join("/")}function u(t){var e=h(t),n=e[0],r=e[1];return n||r?(r&&(r=r.substr(0,r.length-1)),n+r):"."}function c(t,e){var n=h(t)[2];return e&&n.substr(-1*e.length)===e&&(n=n.substr(0,n.length-e.length)),""===n?"/":n}function f(t){return h(t)[3]}function l(t){return"/"===t.charAt(0)?!0:!1}function d(t){return-1!==(""+t).indexOf("\0")?!0:!1}var p=/^(\/?)([\s\S]+\/(?!$)|\/)?((?:\.{1,2}$|[\s\S]+?)?(\.[^.\/]*)?)$/,h=function(t){var e=p.exec(t);return[e[1]||"",e[2]||"",e[3]||"",e[4]||""]};e.exports={normalize:o,resolve:i,join:s,relative:a,sep:"/",delimiter:":",dirname:u,basename:c,extname:f,isAbsolute:l,isNull:d}},{}],23:[function(t,e){var n=t("./indexeddb.js"),r=t("./websql.js"),i=t("./memory.js");e.exports={IndexedDB:n,WebSQL:r,Memory:i,Default:n,Fallback:function(){function t(){throw"[Filer Error] Your browser doesn't support IndexedDB or WebSQL."}return n.isSupported()?n:r.isSupported()?r:(t.isSupported=function(){return!1},t)}()}},{"./indexeddb.js":24,"./memory.js":25,"./websql.js":26}],24:[function(t,e){(function(n){function r(t,e){var n=t.transaction(u,e);this.objectStore=n.objectStore(u)}function i(t,e,n){try{var r=t.get(e);r.onsuccess=function(t){var e=t.target.result;n(null,e)},r.onerror=function(t){n(t)}}catch(i){n(i)}}function o(t,e,n,r){try{var i=t.put(n,e);i.onsuccess=function(t){var e=t.target.result;r(null,e)},i.onerror=function(t){r(t)}}catch(o){r(o)}}function s(t){this.name=t||a,this.db=null}var a=t("../constants.js").FILE_SYSTEM_NAME,u=t("../constants.js").FILE_STORE_NAME,c=t("../constants.js").IDB_RW;t("../constants.js").IDB_RO;var f=t("../errors.js"),l=t("../buffer.js"),d=n.indexedDB||n.mozIndexedDB||n.webkitIndexedDB||n.msIndexedDB;r.prototype.clear=function(t){try{var e=this.objectStore.clear();e.onsuccess=function(){t()},e.onerror=function(e){t(e)}}catch(n){t(n)}},r.prototype.getObject=function(t,e){i(this.objectStore,t,e)},r.prototype.getBuffer=function(t,e){i(this.objectStore,t,function(t,n){return t?e(t):(e(null,new l(n)),void 0)})},r.prototype.putObject=function(t,e,n){o(this.objectStore,t,e,n)},r.prototype.putBuffer=function(t,e,n){o(this.objectStore,t,e.buffer,n)},r.prototype.delete=function(t,e){try{var n=this.objectStore.delete(t);n.onsuccess=function(t){var n=t.target.result;e(null,n)},n.onerror=function(t){e(t)}}catch(r){e(r)}},s.isSupported=function(){return!!d},s.prototype.open=function(t){var e=this;if(e.db)return t();var n=d.open(e.name);n.onupgradeneeded=function(t){var e=t.target.result;e.objectStoreNames.contains(u)&&e.deleteObjectStore(u),e.createObjectStore(u)},n.onsuccess=function(n){e.db=n.target.result,t()},n.onerror=function(){t(new f.EINVAL("IndexedDB cannot be accessed. If private browsing is enabled, disable it."))}},s.prototype.getReadOnlyContext=function(){return new r(this.db,c)},s.prototype.getReadWriteContext=function(){return new r(this.db,c)},e.exports=s}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../buffer.js":11,"../constants.js":12,"../errors.js":15}],25:[function(t,e){function n(t,e){this.readOnly=e,this.objectStore=t}function r(t){this.name=t||i}var i=t("../constants.js").FILE_SYSTEM_NAME,o=t("../../lib/async.js").setImmediate,s=function(){var t={};return function(e){return t.hasOwnProperty(e)||(t[e]={}),t[e]}}();n.prototype.clear=function(t){if(this.readOnly)return o(function(){t("[MemoryContext] Error: write operation on read only context")}),void 0;var e=this.objectStore;Object.keys(e).forEach(function(t){delete e[t]}),o(t)},n.prototype.getObject=n.prototype.getBuffer=function(t,e){var n=this;o(function(){e(null,n.objectStore[t])})},n.prototype.putObject=n.prototype.putBuffer=function(t,e,n){return this.readOnly?(o(function(){n("[MemoryContext] Error: write operation on read only context")}),void 0):(this.objectStore[t]=e,o(n),void 0)},n.prototype.delete=function(t,e){return this.readOnly?(o(function(){e("[MemoryContext] Error: write operation on read only context")}),void 0):(delete this.objectStore[t],o(e),void 0)},r.isSupported=function(){return!0},r.prototype.open=function(t){this.db=s(this.name),o(t)},r.prototype.getReadOnlyContext=function(){return new n(this.db,!0)},r.prototype.getReadWriteContext=function(){return new n(this.db,!1)},e.exports=r},{"../../lib/async.js":1,"../constants.js":12}],26:[function(t,e){(function(n){function r(t,e){var n=this;this.getTransaction=function(r){return n.transaction?(r(n.transaction),void 0):(t[e?"readTransaction":"transaction"](function(t){n.transaction=t,r(t)}),void 0)}}function i(t,e,n){function r(t,e){var r=0===e.rows.length?null:e.rows.item(0).data;n(null,r)}function i(t,e){n(e)}t(function(t){t.executeSql("SELECT data FROM "+u+" WHERE id = ? LIMIT 1;",[e],r,i)})}function o(t,e,n,r){function i(){r(null)}function o(t,e){r(e)}t(function(t){t.executeSql("INSERT OR REPLACE INTO "+u+" (id, data) VALUES (?, ?);",[e,n],i,o)})}function s(t){this.name=t||a,this.db=null}var a=t("../constants.js").FILE_SYSTEM_NAME,u=t("../constants.js").FILE_STORE_NAME,c=t("../constants.js").WSQL_VERSION,f=t("../constants.js").WSQL_SIZE,l=t("../constants.js").WSQL_DESC,d=t("../errors.js"),p=t("../buffer.js"),h=t("base64-arraybuffer");r.prototype.clear=function(t){function e(e,n){t(n)}function n(){t(null)}this.getTransaction(function(t){t.executeSql("DELETE FROM "+u+";",[],n,e)})},r.prototype.getObject=function(t,e){i(this.getTransaction,t,function(t,n){if(t)return e(t);try{n&&(n=JSON.parse(n))}catch(r){return e(r)}e(null,n)})},r.prototype.getBuffer=function(t,e){i(this.getTransaction,t,function(t,n){if(t)return e(t);if(n||""===n){var r=h.decode(n);n=new p(r)}e(null,n)})},r.prototype.putObject=function(t,e,n){var r=JSON.stringify(e);o(this.getTransaction,t,r,n)},r.prototype.putBuffer=function(t,e,n){var r=h.encode(e.buffer);o(this.getTransaction,t,r,n)},r.prototype.delete=function(t,e){function n(){e(null)}function r(t,n){e(n)}this.getTransaction(function(e){e.executeSql("DELETE FROM "+u+" WHERE id = ?;",[t],n,r)})},s.isSupported=function(){return!!n.openDatabase},s.prototype.open=function(t){function e(e,n){5===n.code&&t(new d.EINVAL("WebSQL cannot be accessed. If private browsing is enabled, disable it.")),t(n)}function r(){i.db=o,t()}var i=this;if(i.db)return t();var o=n.openDatabase(i.name,c,l,f);return o?(o.transaction(function(t){function n(t){t.executeSql("CREATE INDEX IF NOT EXISTS idx_"+u+"_id"+" on "+u+" (id);",[],r,e)}t.executeSql("CREATE TABLE IF NOT EXISTS "+u+" (id unique, data TEXT);",[],n,e)}),void 0):(t("[WebSQL] Unable to open database."),void 0)},s.prototype.getReadOnlyContext=function(){return new r(this.db,!0)},s.prototype.getReadWriteContext=function(){return new r(this.db,!1)},e.exports=s}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../buffer.js":11,"../constants.js":12,"../errors.js":15,"base64-arraybuffer":5}],27:[function(t,e){function n(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=0|16*Math.random(),n="x"==t?e:8|3&e;return n.toString(16)}).toUpperCase()}function r(){}function i(t){for(var e=[],n=t.length,r=0;n>r;r++)e[r]=t[r];return e}e.exports={guid:n,u8toArray:i,nop:r}},{}],28:[function(t,e){var n=t("../constants.js").ENVIRONMENT;e.exports=function(t){t=t||{},t.TMP=t.TMP||n.TMP,t.PATH=t.PATH||n.PATH,this.get=function(e){return t[e]},this.set=function(e,n){t[e]=n}}},{"../constants.js":12}],29:[function(t,e){function n(t,e){e=e||{};var n=new o(e.env),s="/";Object.defineProperty(this,"fs",{get:function(){return t},enumerable:!0}),Object.defineProperty(this,"env",{get:function(){return n},enumerable:!0}),this.cd=function(e,n){e=r.resolve(s,e),t.stat(e,function(t,r){return t?(n(new i.ENOTDIR(null,e)),void 0):("DIRECTORY"===r.type?(s=e,n()):n(new i.ENOTDIR(null,e)),void 0)})},this.pwd=function(){return s}}var r=t("../path.js"),i=t("../errors.js"),o=t("./environment.js"),s=t("../../lib/async.js");t("../encoding.js"),n.prototype.exec=function(t,e,n){var i=this,o=i.fs;"function"==typeof e&&(n=e,e=[]),e=e||[],n=n||function(){},t=r.resolve(i.pwd(),t),o.readFile(t,"utf8",function(t,r){if(t)return n(t),void 0;try{var i=Function("fs","args","callback",r);i(o,e,n)}catch(s){n(s)}})},n.prototype.touch=function(t,e,n){function i(t){a.writeFile(t,"",n)}function o(t){var r=Date.now(),i=e.date||r,o=e.date||r;a.utimes(t,i,o,n)}var s=this,a=s.fs;"function"==typeof e&&(n=e,e={}),e=e||{},n=n||function(){},t=r.resolve(s.pwd(),t),a.stat(t,function(r){r?e.updateOnly===!0?n():i(t):o(t)})},n.prototype.cat=function(t,e){function n(t,e){var n=r.resolve(o.pwd(),t);a.readFile(n,"utf8",function(t,n){return t?(e(t),void 0):(u+=n+"\n",e(),void 0)})}var o=this,a=o.fs,u="";return e=e||function(){},t?(t="string"==typeof t?[t]:t,s.eachSeries(t,n,function(t){t?e(t):e(null,u.replace(/\n$/,""))}),void 0):(e(new i.EINVAL("Missing files argument")),void 0)},n.prototype.ls=function(t,e,n){function o(t,n){var i=r.resolve(a.pwd(),t),c=[];u.readdir(i,function(t,a){function f(t,n){t=r.join(i,t),u.stat(t,function(s,a){if(s)return n(s),void 0;var u={path:r.basename(t),links:a.nlinks,size:a.size,modified:a.mtime,type:a.type};e.recursive&&"DIRECTORY"===a.type?o(r.join(i,u.path),function(t,e){return t?(n(t),void 0):(u.contents=e,c.push(u),n(),void 0)}):(c.push(u),n())})}return t?(n(t),void 0):(s.eachSeries(a,f,function(t){n(t,c)}),void 0)})}var a=this,u=a.fs;return"function"==typeof e&&(n=e,e={}),e=e||{},n=n||function(){},t?(o(t,n),void 0):(n(new i.EINVAL("Missing dir argument")),void 0)},n.prototype.rm=function(t,e,n){function o(t,n){t=r.resolve(a.pwd(),t),u.stat(t,function(a,c){return a?(n(a),void 0):"FILE"===c.type?(u.unlink(t,n),void 0):(u.readdir(t,function(a,c){return a?(n(a),void 0):0===c.length?(u.rmdir(t,n),void 0):e.recursive?(c=c.map(function(e){return r.join(t,e)}),s.eachSeries(c,o,function(e){return e?(n(e),void 0):(u.rmdir(t,n),void 0)}),void 0):(n(new i.ENOTEMPTY(null,t)),void 0)}),void 0)})}var a=this,u=a.fs;return"function"==typeof e&&(n=e,e={}),e=e||{},n=n||function(){},t?(o(t,n),void 0):(n(new i.EINVAL("Missing path argument")),void 0)},n.prototype.tempDir=function(t){var e=this,n=e.fs,r=e.env.get("TMP");t=t||function(){},n.mkdir(r,function(){t(null,r)})},n.prototype.mkdirp=function(t,e){function n(t,e){s.stat(t,function(o,a){if(a){if(a.isDirectory())return e(),void 0;if(a.isFile())return e(new i.ENOTDIR(null,t)),void 0}else{if(o&&"ENOENT"!==o.code)return e(o),void 0;var u=r.dirname(t);"/"===u?s.mkdir(t,function(t){return t&&"EEXIST"!=t.code?(e(t),void 0):(e(),void 0)}):n(u,function(n){return n?e(n):(s.mkdir(t,function(t){return t&&"EEXIST"!=t.code?(e(t),void 0):(e(),void 0)}),void 0)})}})}var o=this,s=o.fs;return e=e||function(){},t?"/"===t?(e(),void 0):(n(t,e),void 0):(e(new i.EINVAL("Missing path argument")),void 0)},e.exports=n},{"../../lib/async.js":1,"../encoding.js":14,"../errors.js":15,"../path.js":22,"./environment.js":28}],30:[function(t,e){function n(t,e){this.node=t.id,this.dev=e,this.size=t.size,this.nlinks=t.nlinks,this.atime=t.atime,this.mtime=t.mtime,this.ctime=t.ctime,this.type=t.mode}var r=t("./constants.js");n.prototype.isFile=function(){return this.type===r.MODE_FILE},n.prototype.isDirectory=function(){return this.type===r.MODE_DIRECTORY},n.prototype.isSymbolicLink=function(){return this.type===r.MODE_SYMBOLIC_LINK},n.prototype.isSocket=n.prototype.isFIFO=n.prototype.isCharacterDevice=n.prototype.isBlockDevice=function(){return!1},e.exports=n},{"./constants.js":12}],31:[function(t,e){function n(t){var e=Date.now();this.id=r.SUPER_NODE_ID,this.mode=r.MODE_META,this.atime=t.atime||e,this.ctime=t.ctime||e,this.mtime=t.mtime||e,this.rnode=t.rnode}var r=t("./constants.js");n.create=function(t,e){t.guid(function(r,i){return r?(e(r),void 0):(t.rnode=t.rnode||i,e(null,new n(t)),void 0)})},e.exports=n},{"./constants.js":12}]},{},[19])(19)});